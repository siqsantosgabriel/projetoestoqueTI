<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA TI - SD & NOC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg-body: #f8f9fa; --sidebar-bg: #212529; --card-bg: #ffffff; --primary-color: #0d6efd; --text-main: #333; --accent: #ffd700; --header-bg: #f8f9fa; }
        [data-bs-theme="dark"] { --bg-body: #121212; --sidebar-bg: #1a1a1a; --card-bg: #1e1e1e; --text-main: #e0e0e0; --header-bg: #252525; }
        .setor-sd { --primary-color: #0d6efd; --accent: #ffd700; }
        .setor-noc { --primary-color: #198754; --accent: #20c997; }
        body { background-color: var(--bg-body); color: var(--text-main); font-family: 'Inter', sans-serif; transition: 0.3s; overflow-x: hidden; }
        .wrapper { display: flex; width: 100%; align-items: stretch; }
        #sidebar { min-width: 250px; max-width: 250px; background: var(--sidebar-bg); color: #fff; transition: all 0.3s; min-height: 100vh; }
        #content { width: 100%; padding: 30px; }
        .sidebar-header { padding: 20px; background: rgba(0,0,0,0.1); text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .nav-link { color: rgba(255,255,255,0.7); padding: 15px 20px; display: block; text-decoration: none; cursor: pointer; }
        .nav-link:hover { background: rgba(255,255,255,0.1); color: var(--accent); }
        .card { background-color: var(--card-bg); border: none; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; border-top: 4px solid var(--primary-color); }
        .card-header-custom { background-color: var(--header-bg) !important; color: var(--text-main); border-bottom: 1px solid rgba(0,0,0,0.1); font-weight: bold; }
        .row-baixo { border-left: 5px solid #ffc107 !important; }
        .row-zero { border-left: 5px solid #dc3545 !important; background-color: rgba(220, 53, 69, 0.05); }
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a1a1a; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .login-card { width: 380px; padding: 40px; border-radius: 20px; background: #fff; }
        .theme-toggle { position: fixed; top: 20px; right: 20px; z-index: 1000; cursor: pointer; font-size: 24px; color: var(--primary-color); }
        .admin-only { display: none !important; }
        .log-entrada { color: #198754; font-weight: bold; }
        .log-saida { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body data-bs-theme="light" class="setor-sd">

<div id="loginOverlay">
    <div class="login-card text-center text-dark shadow-lg">
        <h2 class="fw-bold mb-4">ESTOQUE TI</h2>
        <input type="text" id="userInput" class="form-control mb-3" placeholder="Usu√°rio">
        <input type="password" id="senhaInput" class="form-control mb-4" placeholder="Senha">
        <button onclick="verificarLogin()" class="btn btn-primary w-100 shadow fw-bold">ENTRAR</button>
        <p id="erroLogin" class="text-danger mt-3 small" style="display:none;">Acesso negado!</p>
    </div>
</div>

<div class="wrapper" id="conteudoSistema" style="display:none;">
    <nav id="sidebar">
        <div class="sidebar-header"><h4 class="fw-bold mb-0">TI - <span id="setorDisplay">SD</span></h4></div>
        <ul class="list-unstyled mt-4">
            <li><a class="nav-link active"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a></li>
            <li><a onclick="toggleLogs()" class="nav-link"><i class="bi bi-clock-history me-2"></i> Hist√≥rico</a></li>
            <li class="admin-only">
                <a data-bs-toggle="modal" data-bs-target="#modalGestaoUsuarios" class="nav-link"><i class="bi bi-people me-2"></i> Equipe</a>
                <div class="dropdown px-3 mt-2">
                    <button class="btn btn-sm btn-outline-light dropdown-toggle w-100 shadow-none" type="button" data-bs-toggle="dropdown">Mudar Ambiente</button>
                    <ul class="dropdown-menu dropdown-menu-dark">
                        <li><a class="dropdown-item" onclick="mudarSetorAdmin('SD')">Ambiente SD</a></li>
                        <li><a class="dropdown-item" onclick="mudarSetorAdmin('NOC')">Ambiente NOC</a></li>
                    </ul>
                </div>
            </li>
            <li class="admin-only mt-2"><a onclick="exportarCSV()" class="nav-link text-success"><i class="bi bi-file-earmark-arrow-down me-2"></i> Exportar Dados</a></li>
            <hr class="mx-3 opacity-25">
            <li><a data-bs-toggle="modal" data-bs-target="#modalMinhaSenha" class="nav-link"><i class="bi bi-person-lock me-2"></i> Minha Senha</a></li>
            <li><a href="." class="nav-link text-danger"><i class="bi bi-box-arrow-right me-2"></i> Sair</a></li>
        </ul>
    </nav>

    <div id="content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div><h4 class="fw-bold mb-0">Gest√£o <span id="setorTitle">SD</span></h4><p class="text-muted mb-0">Usu√°rio: <span id="userLogado" class="text-primary fw-bold"></span></p></div>
            <i class="bi bi-brightness-high-fill theme-toggle" onclick="toggleTheme()" id="themeIcon"></i>
        </div>
        <div class="row mb-4 text-center">
            <div class="col-md-3"><div class="card p-3 shadow-sm"><h6>Itens</h6><h3 class="fw-bold" id="dashTotal">0</h3></div></div>
            <div class="col-md-3"><div class="card p-3 shadow-sm text-danger"><h6>Alertas</h6><h3 class="fw-bold" id="dashAlerta">0</h3></div></div>
            <div class="col-md-6"><div class="card p-3 shadow-sm"><div style="height: 120px;"><canvas id="meuGrafico"></canvas></div></div></div>
        </div>
        <div class="card shadow-sm border-0">
            <div class="p-3 card-header-custom d-flex justify-content-between align-items-center rounded-top">
                <h6 class="mb-0 fw-bold">ESTOQUE <span id="tabelaLabel">SD</span></h6>
                <div class="d-flex gap-2">
                    <input type="text" id="inputBusca" class="form-control form-control-sm" placeholder="üîç Buscar item...">
                    <button class="btn btn-warning btn-sm fw-bold shadow-sm" data-bs-toggle="modal" data-bs-target="#modalCadastro">+ ITEM</button>
                </div>
            </div>
            <div class="table-responsive"><table class="table table-hover mb-0 align-middle"><thead><tr><th class="ps-4">Produto</th><th>Saldo</th><th>M√≠n</th><th class="text-center">A√ß√µes</th><th class="text-end pe-4 admin-only">Excluir</th></tr></thead><tbody id="tabelaCorpo"></tbody></table></div>
        </div>
        <div id="secaoLogs" style="display:none;" class="mt-4">
            <div class="card shadow-sm">
                <div class="p-3 card-header-custom d-flex justify-content-between align-items-center rounded-top">
                    <h6 class="mb-0 fw-bold">MOVIMENTA√á√ïES <span id="logLabel">SD</span></h6>
                    <div class="d-flex gap-2 align-items-center">
                        <input type="text" id="inputBuscaLog" class="form-control form-control-sm" placeholder="üîç Pesquisar logs...">
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-secondary active" onclick="filtrarLog('TUDO')">Tudo</button>
                            <button class="btn btn-outline-success" onclick="filtrarLog('ENTRADA')">Entradas</button>
                            <button class="btn btn-outline-danger" onclick="filtrarLog('SA√çDA')">Sa√≠das</button>
                        </div>
                    </div>
                </div>
                <div class="list-group list-group-flush" id="listaLogs" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalGestaoUsuarios" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content border-0 shadow"><div class="modal-header bg-dark text-white d-flex justify-content-between align-items-center w-100"><h5 class="mb-0">Gest√£o de Equipe</h5><button onclick="mostrarFormUsuario()" class="btn btn-warning btn-sm fw-bold shadow-sm">+ NOVO</button></div><div class="modal-body"><div id="formUsuarioAdmin" class="mb-4 bg-light p-3 rounded text-dark shadow-sm" style="display:none;"><div class="row g-2"><input type="hidden" id="editUserOldName"><div class="col-md-3"><input type="text" id="novoUserLogin" class="form-control shadow-sm" placeholder="Login"></div><div class="col-md-3"><input type="text" id="novoUserSenha" class="form-control shadow-sm" placeholder="Senha"></div><div class="col-md-3"><select id="novoUserSetor" class="form-select shadow-sm"><option value="SD">SD</option><option value="NOC">NOC</option></select></div><div class="col-md-3 d-flex gap-1"><button onclick="cadastrarUsuario()" class="btn btn-primary flex-grow-1 shadow-sm">Salvar</button><button onclick="esconderFormUsuario()" class="btn btn-outline-secondary shadow-sm">X</button></div></div></div><table class="table table-sm align-middle"><thead><tr><th class="ps-2">Usu√°rio</th><th>Setor</th><th class="text-end pe-3">A√ß√µes</th></tr></thead><tbody id="tabelaUsuariosAdmin"></tbody></table></div></div></div></div>

<div class="modal fade" id="modalMinhaSenha" tabindex="-1"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><h5>Mudar Senha</h5></div><div class="modal-body"><input type="password" id="novaSenhaPessoal" class="form-control shadow-sm" placeholder="Nova Senha"></div><div class="modal-footer"><button onclick="salvarMinhaSenha()" class="btn btn-primary w-100 shadow-sm">Atualizar</button></div></div></div></div>
<div class="modal fade" id="modalEntrada" tabindex="-1"><div class="modal-dialog modal-sm"><div class="modal-content border-0 shadow"><div class="modal-header bg-success text-white"><h5>Entrada</h5></div><div class="modal-body"><input type="hidden" id="idEntrada"><input type="number" id="qtdEntrada" class="form-control shadow-sm" placeholder="Quantidade"></div><div class="modal-footer"><button onclick="confirmarEntrada()" class="btn btn-success w-100 shadow-sm">Confirmar</button></div></div></div></div>
<div class="modal fade" id="modalSaida" tabindex="-1"><div class="modal-dialog modal-sm"><div class="modal-content border-0 shadow"><div class="modal-header bg-danger text-white"><h5>Sa√≠da</h5></div><div class="modal-body"><input type="hidden" id="idSaida"><input type="number" id="qtdSaida" class="form-control mb-2 shadow-sm" placeholder="Qtd"><input type="text" id="osSaida" class="form-control mb-2 shadow-sm" placeholder="OS"><input type="text" id="colabSaida" class="form-control shadow-sm" placeholder="Recebedor"></div><div class="modal-footer"><button onclick="confirmarSaida()" class="btn btn-danger w-100 shadow-sm">Confirmar</button></div></div></div></div>
<div class="modal fade" id="modalCadastro" tabindex="-1"><div class="modal-dialog modal-sm"><div class="modal-content border-0 shadow"><div class="modal-header bg-warning text-white"><h5>Novo Item</h5></div><div class="modal-body"><input type="text" id="nomeNovo" class="form-control mb-2 shadow-sm" placeholder="Nome"><input type="number" id="qtdNovo" class="form-control mb-2 shadow-sm" placeholder="Saldo"><input type="number" id="minNovo" class="form-control mb-2 shadow-sm" placeholder="M√≠nimo"></div><div class="modal-footer"><button onclick="salvarNovoProduto()" class="btn btn-dark w-100 shadow-sm">Cadastrar</button></div></div></div></div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, update, push, remove, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyA4lwZX_GwaTuMAjmfZB3N-zaF869DV6rE",
        authDomain: "projetoestoqueti.firebaseapp.com",
        databaseURL: "https://projetoestoqueti-default-rtdb.firebaseio.com",
        projectId: "projetoestoqueti",
        storageBucket: "projetoestoqueti.firebasestorage.app",
        messagingSenderId: "787336391551",
        appId: "1:787336391551:web:021e81574a1e0bd4dd084a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let dadosAtuais = {}, logsAtuais = {}, usuariosAtuais = {}, userLogado = "", setorAtivo = "SD", chartInstance = null, filtroLogAtivo = 'TUDO';

    function limparForms() {
        ['qtdEntrada', 'qtdSaida', 'osSaida', 'colabSaida', 'nomeNovo', 'qtdNovo', 'minNovo', 'novaSenhaPessoal', 'novoUserLogin', 'novoUserSenha', 'editUserOldName'].forEach(id => {
            const el = document.getElementById(id); if(el) el.value = '';
        });
    }

    onValue(ref(db, 'usuarios/'), s => {
        usuariosAtuais = s.val() || {};
        const corpoAdmin = document.getElementById('tabelaUsuariosAdmin');
        corpoAdmin.innerHTML = '';
        Object.keys(usuariosAtuais).forEach(u => {
            const info = usuariosAtuais[u];
            corpoAdmin.innerHTML += `<tr><td class="ps-2 fw-semibold">${u}</td><td><span class="badge bg-secondary">${info.setor || 'SD'}</span></td><td class="text-end pe-2">
                <button onclick="prepararEdicao('${u}', '${info.senha}', '${info.setor || 'SD'}')" class="btn btn-sm btn-link me-1 text-decoration-none shadow-none">Editar</button>
                <button onclick="removerUsuario('${u}')" class="btn btn-sm btn-outline-danger ${u==='brunosantos'?'disabled':''} shadow-none">X</button>
            </td></tr>`;
        });
    });

    window.verificarLogin = async () => {
        const u = document.getElementById('userInput').value.toLowerCase().trim();
        const p = document.getElementById('senhaInput').value;
        const info = usuariosAtuais[u];
        if ((u === "brunosantos" && p === "prvl123") || (info && info.senha === p)) {
            if (u === "brunosantos" && !info) await set(ref(db, `usuarios/brunosantos`), { senha: "prvl123", setor: "SD" });
            userLogado = u;
            setorAtivo = (u === "brunosantos") ? "SD" : (info.setor || "SD");
            document.getElementById('userLogado').innerText = u;
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('conteudoSistema').style.display = 'flex';
            if(u === "brunosantos") document.querySelectorAll('.admin-only').forEach(el => el.style.setProperty('display', 'block', 'important'));
            atualizarSetorVisual();
        } else { document.getElementById('erroLogin').style.display = 'block'; }
    };

    function atualizarSetorVisual() {
        document.body.className = setorAtivo === 'SD' ? 'setor-sd' : 'setor-noc';
        document.getElementById('setorDisplay').innerText = setorAtivo;
        document.getElementById('setorTitle').innerText = setorAtivo;
        document.getElementById('tabelaLabel').innerText = setorAtivo;
        document.getElementById('logLabel').innerText = setorAtivo;
        conectarFirebaseSetor();
    }

    window.mudarSetorAdmin = (novoSetor) => { setorAtivo = novoSetor; atualizarSetorVisual(); };

    function conectarFirebaseSetor() {
        onValue(ref(db, `estoque_${setorAtivo}/`), s => { dadosAtuais = s.val() || {}; render(); });
        onValue(ref(db, `logs_${setorAtivo}/`), s => { logsAtuais = s.val() || {}; render(); });
    }

    function render() {
        const corpo = document.getElementById('tabelaCorpo');
        const lista = document.getElementById('listaLogs');
        const buscaProd = document.getElementById('inputBusca').value.toLowerCase();
        const buscaLog = document.getElementById('inputBuscaLog').value.toLowerCase();
        corpo.innerHTML = ''; lista.innerHTML = '';
        let tot = 0, al = 0;

        Object.keys(dadosAtuais).forEach(id => {
            const p = dadosAtuais[id]; tot++;
            const zero = p.quantidade <= 0;
            const baixo = p.quantidade <= p.estoqueMinimo;
            if(baixo) al++;
            if(p.nome.toLowerCase().includes(buscaProd)) {
                let btnDel = userLogado === 'brunosantos' ? `<td class="text-end pe-4 admin-only" style="display:table-cell!important"><button onclick="del('${id}')" class="btn btn-sm text-muted p-0 shadow-none"><i class="bi bi-trash"></i></button></td>` : '';
                corpo.innerHTML += `<tr class="${zero ? 'row-zero' : (baixo ? 'row-baixo' : '')}">
                    <td class="ps-4 fw-semibold">${p.nome}</td>
                    <td><span class="badge ${zero ? 'bg-danger' : (baixo ? 'bg-warning text-dark' : 'bg-success')}">${p.quantidade}</span></td>
                    <td>${p.estoqueMinimo}</td>
                    <td class="text-center"><button onclick="abrirEntrada('${id}')" class="btn btn-sm btn-outline-success"><i class="bi bi-plus-lg"></i></button> <button onclick="abrirSaida('${id}')" class="btn btn-sm btn-outline-danger mx-1"><i class="bi bi-dash-lg"></i></button></td>
                    ${btnDel}
                </tr>`;
            }
        });

        Object.keys(logsAtuais).reverse().forEach(id => {
            const l = logsAtuais[id];
            const textoBusca = `${l.prod} ${l.user} ${l.os || ''} ${l.colab || ''}`.toLowerCase();
            if(filtroLogAtivo !== 'TUDO' && l.tipo !== filtroLogAtivo) return;
            if(!textoBusca.includes(buscaLog)) return;
            const classeTipo = l.tipo === 'ENTRADA' ? 'log-entrada' : 'log-saida';
            const btnDelLog = userLogado === 'brunosantos' ? `<button onclick="delLog('${id}')" class="btn btn-sm text-muted p-0 ms-2"><i class="bi bi-x-circle"></i></button>` : '';
            const recInfo = l.colab ? `| Rec: ${l.colab}` : '';
            lista.innerHTML += `<div class="list-group-item d-flex justify-content-between align-items-center small">
                <div><span class="${classeTipo}">${l.tipo}</span>: <b>${l.prod}</b> (${l.qtd}x) | TI: ${l.user} | OS: ${l.os || '-'} ${recInfo} | ${l.data}</div>
                ${btnDelLog}
            </div>`;
        });
        document.getElementById('dashTotal').innerText = tot;
        document.getElementById('dashAlerta').innerText = al;
        renderizarGrafico();
    }

    window.toggleTheme = () => { document.body.setAttribute('data-bs-theme', document.body.getAttribute('data-bs-theme') === 'light' ? 'dark' : 'light'); render(); };
    window.toggleLogs = () => { const s = document.getElementById('secaoLogs'); s.style.display = s.style.display==='none'?'block':'none'; };
    window.filtrarLog = (t) => { filtroLogAtivo = t; document.querySelectorAll('.btn-group button').forEach(b => b.classList.remove('active')); event.target.classList.add('active'); render(); };
    window.abrirEntrada = id => { limparForms(); document.getElementById('idEntrada').value = id; new bootstrap.Modal('#modalEntrada').show(); };
    window.confirmarEntrada = () => {
        const id = document.getElementById('idEntrada').value;
        const q = parseInt(document.getElementById('qtdEntrada').value);
        if(!q) return;
        update(ref(db, `estoque_${setorAtivo}/${id}`), { quantidade: (dadosAtuais[id].quantidade || 0) + q });
        push(ref(db, `logs_${setorAtivo}/`), { tipo: 'ENTRADA', prod: dadosAtuais[id].nome, qtd: q, user: userLogado, data: new Date().toLocaleDateString() });
        bootstrap.Modal.getInstance('#modalEntrada').hide(); limparForms();
    };
    window.abrirSaida = id => { limparForms(); document.getElementById('idSaida').value = id; new bootstrap.Modal('#modalSaida').show(); };
    window.confirmarSaida = () => {
        const id = document.getElementById('idSaida').value;
        const q = parseInt(document.getElementById('qtdSaida').value);
        if(!q || dadosAtuais[id].quantidade < q) return alert("Saldo insuficiente");
        update(ref(db, `estoque_${setorAtivo}/${id}`), { quantidade: dadosAtuais[id].quantidade - q });
        push(ref(db, `logs_${setorAtivo}/`), { tipo: 'SA√çDA', prod: dadosAtuais[id].nome, qtd: q, os: document.getElementById('osSaida').value, colab: document.getElementById('colabSaida').value, user: userLogado, data: new Date().toLocaleDateString() });
        bootstrap.Modal.getInstance('#modalSaida').hide(); limparForms();
    };
    window.salvarNovoProduto = () => {
        const n = document.getElementById('nomeNovo').value; if(!n) return;
        push(ref(db, `estoque_${setorAtivo}/`), { nome: n, quantidade: parseInt(document.getElementById('qtdNovo').value) || 0, estoqueMinimo: parseInt(document.getElementById('minNovo').value) || 0 });
        bootstrap.Modal.getInstance('#modalCadastro').hide(); limparForms();
    };
    window.delLog = id => { if(confirm("Excluir log?")) remove(ref(db, `logs_${setorAtivo}/${id}`)); };
    window.del = id => { if(confirm("Excluir item?")) remove(ref(db, `estoque_${setorAtivo}/${id}`)); };
    window.exportarCSV = () => {
        let csv = 'sep=,\nTipo,Produto,Quantidade,OS,Responsavel,Recebedor,Data\n';
        Object.values(logsAtuais).forEach(l => csv += `${l.tipo},${l.prod},${l.qtd},${l.os||''},${l.user},${l.colab||''},${l.data}\n`);
        const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob(["\ufeff" + csv], { type: 'text/csv' })); a.download = `estoque_${setorAtivo}.csv`; a.click();
    };
    window.renderizarGrafico = () => {
        const ctx = document.getElementById('meuGrafico').getContext('2d');
        const counts = {};
        Object.values(logsAtuais).forEach(l => { if(l.tipo === 'SA√çDA') counts[l.prod] = (counts[l.prod] || 0) + parseInt(l.qtd); });
        const labels = Object.keys(counts).sort((a,b) => counts[b] - counts[a]).slice(0, 5);
        if(chartInstance) chartInstance.destroy();
        chartInstance = new Chart(ctx, {
            type: 'bar',
            data: { labels, datasets: [{ label: 'Sa√≠das', data: labels.map(l => counts[l]), backgroundColor: setorAtivo === 'SD' ? '#ffd700' : '#20c997', borderRadius: 4 }] },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
    };
    window.prepararEdicao = (u, p, s) => { document.getElementById('editUserOldName').value = u; document.getElementById('novoUserLogin').value = u; document.getElementById('novoUserSenha').value = p; document.getElementById('novoUserSetor').value = s; document.getElementById('formUsuarioAdmin').style.display = 'block'; };
    window.cadastrarUsuario = () => { const old = document.getElementById('editUserOldName').value; const nU = document.getElementById('novoUserLogin').value.toLowerCase().trim(); const nP = document.getElementById('novoUserSenha').value.trim(); const nS = document.getElementById('novoUserSetor').value; if(nU && nP) { if(old && old !== nU) remove(ref(db, `usuarios/${old}`)); set(ref(db, `usuarios/${nU}`), { senha: nP, setor: nS }); document.getElementById('formUsuarioAdmin').style.display = 'none'; limparForms(); } };
    window.mostrarFormUsuario = () => { limparForms(); document.getElementById('formUsuarioAdmin').style.display = 'block'; };
    window.esconderFormUsuario = () => { document.getElementById('formUsuarioAdmin').style.display = 'none'; limparForms(); };
    window.removerUsuario = u => { if(confirm("Remover?")) remove(ref(db, `usuarios/${u}`)); };
    window.salvarMinhaSenha = () => { set(ref(db, `usuarios/${userLogado}/senha`), document.getElementById('novaSenhaPessoal').value); alert("Ok!"); limparForms(); };
    document.getElementById('inputBusca').addEventListener('input', render);
    document.getElementById('inputBuscaLog').addEventListener('input', render);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
